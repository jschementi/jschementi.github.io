---
title: "MIX10, Part 2.1 – Server-side web development with dynamic languages"
layout: "post"
permalink: "/2010/04/mix10-part-21-server-side-web.html"
uuid: "1793234947390378380"
guid: "tag:blogger.com,1999:blog-5419182.post-1793234947390378380"
date: "2010-04-26 06:35:00"
updated: "2010-07-19 10:12:38"
description: 
blogger:
    siteid: "5419182"
    postid: "1793234947390378380"
    comments: "0"
categories: [MIX10, IIS, Open Source, Dynamic Languages, ASP.NET, talks, IronRuby, Silverlight, IronPython, HAML]
author: 
    name: "Jimmy Schementi"
    url: "https://plus.google.com/116380716127564408544?rel=author"
    image: "//lh6.googleusercontent.com/-Fl3zUgl9dMw/AAAAAAAAAAI/AAAAAAAABYQ/CvQezyGiMP4/s512-c/photo.jpg"
---

<div class="css-full-post-content js-full-post-content">
<div style="border-bottom: #666 5px solid; border-left: #666 5px solid; padding-bottom: 5px; background-color: #333; margin: 0px 0px 10px; padding-left: 5px; padding-right: 5px; color: white; border-top: #666 5px solid; border-right: #666 5px solid; padding-top: 5px">   <p style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" class="section"><em>This post is part of the “MIX10 – Pumping Iron on the web” series:</em></p>    <ul style="padding-bottom: 0px; margin: 0px 0px 0px 20px; padding-left: 0px; padding-right: 0px; padding-top: 0px">     <li><a href="http://blog.jimmy.schementi.com/2010/03/mix10-ironruby-and-ironpython-part-1.html">Part 1 - Introduction</a> </li>      <li><strong>Part 2.1 – Server-side web development with dynamic languages </strong></li>      <li><a href="http://blog.jimmy.schementi.com/2010/04/mix10-part-22-client-side-web.html">Part 2.2 – Client-side web development with dynamic languages</a> </li>      <li><a href="http://blog.jimmy.schementi.com/2010/04/mix10-part-3-using-dynamic-languages-in.html">Part 3 - Using scripting in static applications</a></li>      <li><em>Coming soon: </em>Part 4 - Web-app extensibility with scripts </li>   </ul> </div>  <blockquote>   <p><em>The original post was mistakenly removed, so it’s been reposted with the original post date, 4/25/2010. Sorry if this confuses your blog readers or causes any other inconvenience.</em></p> </blockquote>  <p>One reason for embracing dynamic languages is to make your entire web-development experience simpler, be it on <a href="http://asp.net" target="_blank">ASP.NET</a> enabled web-servers, or on the client through <a href="http://silverlight.net" target="_blank">Silverlight</a>. Let's first look at the server.</p>  <p>Both <a href="http://ironpython.net" target="_blank">IronPython</a> and <a href="http://ironruby.net" target="_blank">IronRuby</a> can run on the same infrastructure as your ASP.NET applications, though in their own ways. Due to historic reasons, IronPython is supported as an ASP.NET language through the <a href="http://aspnet.codeplex.com/wikipage?title=Dynamic%20Language%20Support&amp;referringTitle=Home" target="_blank">ASP.NET Dynamic Language integration</a>, and IronRuby is supported through <a href="http://www.ruby-forum.com/topic/212515" target="_blank">IronRuby.Rack</a>, which enables <a href="http://rack.rubyforge.org/" target="_blank">Rack</a>-based Ruby web-applications to run on ASP.NET. However, both are open-source, so each one could be ported to the other language.</p>  <p>Since these <a href="http://dlr.codeplex.com" target="_blank">DLR</a>-based languages run on ASP.NET, deploying them is no different than any other ASP.NET application; they can be run on any ASP.NET enabled web-server like <a href="http://www.iis.net/" target="_blank">IIS</a>. Keeping that in mind, let’s first look at how simple Ruby web apps can be.</p>  <h4><font color="#ff8000"><strong>Minimal Ruby web-applications</strong></font></h4>  <h5><a href="http://www.sinatrarb.com/" target="_blank"><img style="display: inline" title="Slide34" alt="Slide34" src="http://lh5.ggpht.com/_OqCZhp9yI0Q/TEQIcG9AmwI/AAAAAAAAAWg/m07YG790GLk/Slide345.jpg?imgmax=800" width="400" height="300" /></a> </h5>  <p>Ruby itself has very expressive syntax, and the Ruby community has built many web-frameworks to make web-development really simple. For example, Sinatra is a web-framework made to minimize the amount of code required to respond to web requests:</p> <script src="http://gist.github.com/481096.js?file=helloworld-simple.rb"></script>  <p>The above code does exactly what it says; when a get request happens for <code>'/'</code>, show &quot;Hello, World&quot; on the page. This highlights Ruby's domain-specific language abilities; <code>get</code> looks like a keyword, though it's really just a method call with <code>'/'</code> as the first argument (Ruby lets you omit parenthesis from method calls too ... any VB script fans out there?). The <code>do-end</code> block is syntactic sugar for passing a lambda as the last-argument to the <code>get</code> method; all Ruby methods take an arbitrary &quot;block&quot; of code between <code>do</code>-<code>end</code> or <code>{}</code>. Inside that block is what happens on each request, and whatever is returned is written to the response (<code>&quot;Hello, World&quot;</code>); the last statement of any expression (blocks, methods, if-statements, etc) is implicitly the return value of the statement.</p>  <blockquote>   <p>For all those C# fans, you can use curly-braces too:</p>   <script src="http://gist.github.com/481096.js?file=helloworld-curly.rb"></script></blockquote>  <p>Though these features sound arbitrary by themselves, if I were to write this with only the more-familiar language features found in Ruby, it would lose its character:</p> <script src="http://gist.github.com/481096.js?file=helloworld-verbose.rb"></script>  <p>This defines a Ruby method <code>verbose</code>, which explicitly returns the string &quot;Hello, World&quot;, and then calls the get method directly with the first argument being the URL and the second argument being an explicit pointer to the <code>verbose</code> method. Why does this look so much uglier? While this might be closer to how the programming language actually runs the initial examples, it's not how the programmer thinks.</p>  <p>Not to leave Python out of this love-fest, Python can make this look very pretty as well, but in her own special way. Imagining that a Sinatra-like library exists for Python:</p> <script src="http://gist.github.com/481096.js?file=helloworld.py"></script>  <p>Here the <code>index</code> method is created, which explicitly accepts both the request and the response as arguments; Python's all about being explicit, while Ruby is very implicit. Then the method would be &quot;decorated&quot; with the <code>sinatra.get</code> decorator, which would tell the web-framework that <code>index</code> represents a get-request for &quot;/&quot;.</p>  <blockquote>   <h5><font color="#ff8000"><strong>What's a decorator?</strong></font></h5>    <p>A <a href="http://www.python.org/dev/peps/pep-0318/" target="_blank">Python decorator</a> is basically a function that accepts a function and returns a function, so this imaginary Sinatra-like framework would define <code>get</code> something like this:</p>   <script src="http://gist.github.com/481096.js?file=sinatra.get.py"></script>    <p>Another way of looking at it is without the decorator syntax:</p>   <script src="http://gist.github.com/481096.js?file=helloworld-verbose.py"></script>    <p>It’s a bit more readable than Ruby, and almost equivalent to the decorator way, except for the order of <code>get</code> in the code. You'll also see that getting a method pointer is much cleaner than Ruby (<code>index</code> vs. <code>method(:index)</code>); in Ruby <code>index</code> would call the method, since Ruby allows method calls with or without parenthesis, where Python uses parenthesis to indicate a method call.</p> </blockquote>  <p>Point being is that both Ruby and Python are very expressive in their own ways, and makes it really easy to make simple websites on Windows. The IronRuby team takes of advantage of this to power <a href="http://ironruby.info" target="_blank">http://ironruby.info</a>, a Ruby-compatibility reporting website. This is the code from the <a href="http://github.com/jschementi/ironruby-stats/blob/master/app.rb#L83" target="_blank">main page</a>:</p> <script src="http://gist.github.com/481096.js?file=sinatra-haml.rb"></script>  <p>This renders the <a href="http://github.com/jschementi/ironruby-stats/blob/master/views/index.haml" target="_blank">index.haml</a> template with the data returned from <code>Stats.get_latest</code>, which is pretty much what the code says. The HTML is generated from the <a href="http://haml-lang.com/" target="_blank">haml templating engine</a>, which makes generating HTML and calling Ruby code extremely easy:</p> <script src="http://gist.github.com/481096.js?file=index.haml"></script>  <p>To play around with using HAML, you can use <a href="http://github.com/jschementi/orphanage/tree/master/aspnet-haml/" target="_blank">aspnet-haml</a> to support .haml files though ASP.NET.</p>  <h4><strong><font color="#ff8000">Ruby on Rails - Databases with Ruby</font></strong></h4>  <p><a href="http://rubyonrails.org" target="_blank"><img style="display: inline" title="Slide45" alt="Slide45" src="http://lh3.ggpht.com/_OqCZhp9yI0Q/TEQIcsQcBUI/AAAAAAAAAWk/HjDOc25xSdU/Slide45%5B6%5D.jpg?imgmax=800" width="400" height="300" /></a> </p>  <p>One of the most popular (or most buzzed) web-frameworks is <a href="http://rubyonrails.org/" target="_blank">Ruby on Rails</a>, which is just a collection of Ruby libraries for structuring your web-application. Rails uses the <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" target="_blank">Model-View-Controller pattern</a>, so any <a href="http://www.asp.net/mvc" target="_blank">ASP.NET MVC</a> people will find it a very-familiar framework. However, Rails really shines when it comes to interacting with the database through it's ActiveRecord library (the “Model” layer). ActiveRecord maps Ruby classes to database tables, and provides an Ruby abstraction for interacting with the database:</p> <script src="http://gist.github.com/481096.js?file=rails-example.rb"></script>  <p>This is all the code that is required to map your Ruby classes to the database, as well as create the structure of the database. ActiveRecord dynamically provides getters/setters for the table, as well as sets up foreign-keys and relationships based on conventions (belongs_to :posts assumes that the table has a 'post_id' field).</p>  <p>Interacting with the database is just as easy as calling methods; <code>Post.all</code> translates to the <code>SELECT * from posts</code> SQL query, since the <code>Post</code> object is mapped to the <code>posts</code> database table. <code>Post.find(&lt;id&gt;)</code> does a <code>SELECT * from posts where id=&lt;id&gt;</code>, etc.</p>  <p>Because Rails uses the <a href="http://rack.rubyforge.org/" target="_blank">Rack web-server interface</a>, it will also run on IIS using <a href="http://www.ruby-forum.com/topic/212515" target="_blank">IronRuby.Rack</a>. See <a href="http://ironruby.net/documentation/rails" target="_blank">the IronRuby Rails documentation</a> for more info about using Rails on IronRuby, and the <a href="http://api.rubyonrails.org" target="_blank">Ruby on Rails documentation</a> for general Rails usage.</p>  <h4><strong><font color="#ff8000">ASP.NET MVC and IronRuby</font></strong></h4>  <p>Those were all Ruby-based web-frameworks, but what about using ASP.NET directly? The IronRuby community has developed an <a href="http://github.com/casualjim/ironrubymvc" target="_blank">integration with ASP.NET MVC</a>, so you can write your controllers and views in Ruby. Special thanks to <a href="http://flanders.co.nz/" target="_blank">Ivan Porto Carrero</a> for single-handedly maintaining it.</p>  <h4><strong><font color="#ff8000">ASP.NET and IronPython</font></strong></h4>  <p>Again, to give Python some love, <a href="http://aspnet.codeplex.com/wikipage?title=Dynamic%20Language%20Support" target="_blank">IronPython directly integrates with ASP.NET</a>, letting you write your ASPX code-behind files in Python.</p> <script src="http://gist.github.com/481133.js?file=hello-webforms.aspx"></script><script src="http://gist.github.com/481133.js?file=hello-webforms.aspx.py"></script>  <p>Because of ASP.NET's events-based API (rather than a response-based API like Sinatra/Rails), Python methods can automatically hook events by using the &lt;object&gt;_&lt;event-name&gt; convention, and all server-side controls with &quot;ID&quot;s ends up being a variable available to the Python module. And application-level event hooks can go in global.py. But it's really nice to write Language=&quot;IronPython&quot; at the top. =)</p>  <p>Python code can can also interact with the controls:</p> <script src="http://gist.github.com/481133.js?file=python-controls.aspx"></script>  <p>The &lt;%# %&gt; syntax lets run Python code in the context of the ASP.NET control's data source. The repeater's data-source was set to a list of IMAGETAGS (a python class), which has all those fields on it.</p>  <p>In conclusion, on the server you have many options for using IronRuby and IronPython to simplify your solutions.</p>  <p>Next up, <a href="http://blog.jimmy.schementi.com/2010/04/mix10-part-22-client-side-web.html">using dynamic languages on the client through Silverlight</a>.</p>  
</div>