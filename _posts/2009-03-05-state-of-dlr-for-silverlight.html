---
title: "State of the DLR for Silverlight"
layout: "post"
permalink: "/2009/03/state-of-dlr-for-silverlight.html"
uuid: "4554019320262620641"
guid: "tag:blogger.com,1999:blog-5419182.post-4554019320262620641"
date: "2009-03-05 19:34:00"
updated: "2009-03-05 19:48:20"
description: 
blogger:
    siteid: "5419182"
    postid: "4554019320262620641"
    comments: "9"
categories: [ruby, Dynamic Languages, IronRuby, Silverlight, IronPython, DLR, Python]
author: 
    name: "Jimmy Schementi"
    url: "https://plus.google.com/116380716127564408544?rel=author"
    image: "//lh6.googleusercontent.com/-Fl3zUgl9dMw/AAAAAAAAAAI/AAAAAAAABYQ/CvQezyGiMP4/s512-c/photo.jpg"
---

<div class="css-full-post-content js-full-post-content">
<p>If you’re a frequent reader of this blog, you definitely know what’s going on with the <a href="http://dlr.codeplex.com/" target="_blank">DLR</a> in <a href="http://silverlight.net" target="_blank">Silverlight</a>. For those who are new, or just don’t know, hopefully this post will clarify some things.</p>  <p>First off: my previous entries about Silverlight since <a href="http://sdlsdk.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=17839" target="_blank">sdlsdk-0.4.0</a> dropped:</p>  <ul>   <li><a href="http://blog.jimmy.schementi.com/2008/11/repls-in-silverlight.html" target="_blank">“console=true”: REPLs in Silverlight</a> </li>    <li><a href="http://blog.jimmy.schementi.com/2008/11/adding-scripting-to-c-silverlight-app.html" target="_blank">Adding scripting to a C# Silverlight app</a> </li>    <li><a href="http://blog.jimmy.schementi.com/2008/12/jimmy-hacking-at-microsoft.html" target="_blank">jimmy hacking (at) Microsoft</a> / Silverlight stuff near bottom </li>    <li><a href="http://blog.jimmy.schementi.com/2009/01/dynamic-language-testing-in-silverlight.html" target="_blank">Dynamic Language Testing in Silverlight</a> </li> </ul>  <p>It would seem the next release will be focused around REPLs, testing, scripting support, and maybe some server-side integration pieces. And you’d be right. Proof is in the <a href="http://github.com/jschementi/agdlr" target="_blank">project’s public source code repository</a>. </p>  <p><strong><font color="#ff8000">But what about the dynamic language runtime and the languages themselves?</font></strong></p>  <p>There has not been a new release of <a href="http://sdlsdk.codeplex.com/" target="_blank">sdlsdk</a> for many months, and that’s simply because the above features are not finished, NOT because the DLR and languages have not releases anything for Silverlight since then! The DLR released <a href="http://dlr.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=20378" target="_blank">dlr-0.9</a> and IronPython released <a href="http://ironpython.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=12481" target="_blank">ironpython-2.0.1</a>, both including Silverlight binaries. Also, <a href="http://www.devhawk.net/" target="_blank">Harry Pierson</a> put together a <a href="http://nightlybuilds.cloudapp.net/Project.aspx?project=dlr" target="_blank">nightly build site</a> for the DLR, which includes <a href="http://ironruby.net" target="_blank">IronRuby</a> and <a href="http://ironpython.codeplex.com" target="_blank">IronPython</a>, and had Silverlight-specific builds.</p>  <p><font color="#ff8000"><strong>Then why the sdlsdk project?</strong></font></p>  <p>sdlsdk is the main project and release vehicle for Chiron and Microsoft.Scripting.Silverlight, which makes writing applications in DLR-languages possible. It’s also the place for collaborating and experimenting with crazy usages of Silverlight+DLR. The DLR and languages are parts of other projects, so I can not justify bumping the version number of sdlsdk simply because a new version of IronRuby, IronPython, and the DLR are in there. The easiest way to update sdlsdk’s DLR+languages is to grab a daily build of the DLR and drop the binaries into sdlsdk’s /bin folder. The next sdlsdk release might include a script to automate that, as long as new builds don’t break it. =)</p>  <p>This is possible because the DLR, IronRuby, and IronPython teams use a shared continuous-integration server that runs test suites in Silverlight on each checkin, ensuring that they all continue to work really well.</p>  <h4><font color="#ff8000">Common misconceptions</font></h4>  <p>During development the state of these projects could be completely different within a few weeks, so misconceptions form very fast. Here are ones which beg for correction …</p>  <p><font color="#ff8000"><strong>Chiron, a special HTTP server, performs language compilation on the server and generates a .xap file.</strong></font></p>  <p><strong><font color="#ff8000">FALSE. </font></strong>While <a href="http://sdlsdk.codeplex.com/Wiki/View.aspx?title=Chiron&amp;referringTitle=Getting%20Started" target="_blank">Chiron</a> is a special HTTP server, which generates a XAP file for any given directory, <strong><font color="#ff8000">it does not perform language compilation on the server</font></strong>! Chiron is a development-time tool which only sticks the script files in the XAP, and they are run in the browser. When putting your app into production, you tell Chiron to write the XAP file to disk, and then you can put your app on any web-server you want. </p>  <p>Chiron’s existence shows the limitation Silverlight imposes by <em>requiring</em> a XAP file. DLLs can be downloaded by the AppManifest.xaml outside the XAP, so the XAP just serves as a AppManifest.xaml container. I’m hoping to get this fixed by Silverlight <strong><u>4</u></strong>. =\ It also shows a limitation in not supporting continuations, which would let the user script pause while asynchronously downloading a script file, and then resume the initial script. I’ve been prototyping ways to get around this, but nothing working yet. </p>  <p>Also, if you’re using another web-server in your app (like you have a ASP.NET app with a Silverlight control), you can just set up a file-system-watcher and tell Chiron to regenerate the XAP to disk everytime you edit a file, but it will be served with the other webserver. This is used by <a href="http://www.schementi.com/silverline/" target="_blank">silverline</a>, a Rails plugin I wrote to integration Silverlight and IronRuby.</p>  <p>This is why you can’t include JavaScript files from inside other JavaScript files, and all your dependencies need to be pre-defined in the HTML file, because JavaScript can’t download the script files while the JavaScript engine is running.</p>  <p><strong><font color="#ff8000">Common interface implementations were inconsistent between languages, so I can’t create a solution where advanced users can pick and choose a language.</font></strong></p>  <p><strong><font color="#ff8000">FALSE, in theory. </font></strong><a href="http://dlr.codeplex.com/Project/Download/FileDownload.aspx?DownloadId=59294" target="_blank">The DLR hosting API (contained in Microsoft.Scripting.dll)</a> provides a single set of APIs that can be used to host many languages. For example, <a href="http://github.com/jschementi/agdlr/blob/master/src/Microsoft.Scripting.Silverlight/DynamicApplication.cs" target="_blank">Microsoft.Scripting.Silverlight</a> uses the DLR hosting APIs to run any DLR language in Silverlight, based on what extension the entry-point script has (.py, .rb, etc ...). <a href="http://github.com/jschementi/orphanage/tree/master/hosting" target="_blank">There are simple hosting examples here.</a></p>  <p>It is the language’s responsibility to implement certain interfaces so they are host-able by the DLR. IronRuby and IronPython are existing examples of that, and there is documentation in the hosting spec on how this all works, so new languages can follow suit.</p>  <p>However, there are always going to be language-specific scenarios which have different ways of using the hosting API, or the hosting API doesn’t support the feature and you have to use the language’s hosting API. In those cases, it’s best to re-think your scripting design and make the hosting code as simple as possible.</p>  <p>Also, a couple months ago, IronRuby’s hosting support was no where near where it is today. Again, things change fast. If you have any feedback on DLR hosting, please ask around on the <a href="http://dlr.codeplex.com/Thread/List.aspx" target="_blank">DLR Discussions List</a>.</p>  <h4><font color="#ff8000">And the state is ...</font></h4>  <p>I hope that made some things clear; the DLR, IronRuby, and IronPython are committed to supporting Silverlight developers. Unfortunately, the reverse is less strong, so if this is important to you please talk about it on the <a href="http://silverlight.net/forums/17.aspx" target="_blank">silverlight.net forums</a>. Things might be a bit nicer when the inner ring of the DLR (Microsoft.Scripting.Core.dll) is part of the System.Core in Silverlight, but we’ll see.</p>  
</div>
<div class="css-full-comments-content js-full-comments-content">
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://stimpy77.myopenid.com/">
  <div class="css-comment-name js-comment-name">
    stimpy77
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-05T21:22:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    Heh. As the author of a rant I posted last night to which you seem to be replying, I ...... thank you for the responses.<BR/><BR/>I'm still not happy with seeing Chiron or anything server-side in the mix of a Silverlight/DLR solution. For that matter, I'm not happy at all with Silverlight requiring a .xap file in the first place. In fact, I've been turned off by Silverlight ever since I saw the requirement. I had big plans with inline XAML and was going to use runtime-loaded DLR scripts. Plans, tossed. <BR/><BR/>Glad to see Pything/Ruby/JScript.NET language support, but it's just hard for me to call it DLR if it's bundled in a binary file (.xap), even if Chiron doesn't technically *compile*, it still creates a static binary to get the runtime bundled, and that to me is not DLR.<BR/><BR/>But what the heck, I'm commenting in the context of a DLR hero who knows DLR inside and out. I'll go back to my longing for Active Scripting days, all by myself. :p
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://stimpy77.myopenid.com/">
  <div class="css-comment-name js-comment-name">
    stimpy77
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-05T22:01:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    "Also, a couple months ago, IronRuby’s hosting support was no where near where it is today."<BR/><BR/>Good to know, it was in November or December that I attempted to have a generic DLR runtime module and Ruby didn't implement what it should so I threw all of DLR out because it just wasn't consistent between the languages. If this has changed, I'll give it another shot. :)
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://www.blogger.com/profile/05370777584064015818">
  <div class="css-comment-name js-comment-name">
    Jimmy Schementi
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-05T22:21:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    Welcome. Part in response to you, part &quot;I&#39;m sure others have been wondering the same thing.<BR/><BR/>&gt;&gt;&gt; I&#39;m still not happy with seeing Chiron or anything server-side in the mix of a Silverlight/DLR solution.<BR/><BR/>I agree, but a development-time-only solution makes it a bit nicer. The XAP file is suppose to simulate a read-only filesystem for your app ... since Silverlight is very much a desktop framework hoisted into the web. <BR/><BR/>&gt;&gt;&gt; For that matter, I&#39;m not happy at all with Silverlight requiring a .xap file in the first place. In fact, I&#39;ve been turned off by Silverlight ever since I saw the requirement. I had big plans with inline XAML and was going to use runtime-loaded DLR scripts. Plans, tossed. <BR/><BR/>You can still download script/xaml files on demand, that&#39;s no problem. Like my main app could download and load a file using the DLR ... but it would have to be a async download. This async requirement means we can&#39;t make things work via require or import. And this time it&#39;s not Silverlight&#39;s fault ... the it&#39;s a browser stack restriction. Granted, I could use browser JS to call XmlHttpRequest synchronously, but it could hang the browser and overall isn&#39;t a good strategy. XAP works 100% of the time, while a non-XAP solution is like 50% ... once you try to use an external library it sucks. Again, I&#39;m prototyping some things ... so we&#39;ll see. <BR/><BR/>&gt;&gt;&gt; Glad to see Pything/Ruby/JScript.NET language support, but it&#39;s just hard for me to call it DLR if it&#39;s bundled in a binary file (.xap), even if Chiron doesn&#39;t technically *compile*, it still creates a static binary to get the runtime bundled, and that to me is not DLR.<BR/><BR/>The XAP is for all your dependencies at startup, to work-around the no-synchronous-downloading. After that, you can definitely load XAML/Script/etc from outside the XAP asynchronously. XAP is just a startup-filesystem solution, since scripting languages (except javascript) are so tied to the idea of a filesystem.<BR/><BR/>&gt;&gt;&gt; Good to know, it was in November or December that I attempted to have a generic DLR runtime module and Ruby didn&#39;t implement what it should so I threw all of DLR out because it just wasn&#39;t consistent between the languages. If this has changed, I&#39;ll give it another shot. :)<BR/><BR/>Things are much better now. Good luck, and let me know if you have any other issues, or need it to be easier to get to things outside the XAP.
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://stimpy77.myopenid.com/">
  <div class="css-comment-name js-comment-name">
    stimpy77
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-06T05:41:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    &gt;&gt;&gt;&gt;&gt; I&#39;m still not happy with seeing Chiron or anything server-side in the mix of a Silverlight/DLR solution.&lt;&lt;&lt;&lt;&lt;&lt;<BR/><BR/>&gt;&gt;I agree, but a development-time-only solution makes it a bit nicer. The XAP file is suppose to simulate a read-only filesystem for your app ... since Silverlight is very much a desktop framework hoisted into the web. &lt;&lt;<BR/><BR/>OK wait .. *click*! .. Oooh. So are you saying Chiron wasn&#39;t intended to be something that runs at runtime? Because throwing that gear in the mix of a running web architecture just seemed awfully vulnerable. If Chiron is used only once in the deployment process, and not as a runtime server of sorts .. well, I don&#39;t understand why even that was necessary (why not just use the file system?), but it&#39;s definitely a relief and I feel adequately stupid I hope to your liking.
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://weblogs.asp.net/alexeyzakharov/">
  <div class="css-comment-name js-comment-name">
    Alexey Zakharov
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-06T05:43:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    Hi James,<BR/><BR/>DLR in Silverlight looks very promising. But I've got to main problems with it:<BR/><BR/>1. DLR assemblies are not included to Silverlight Core. That is why people should download additional 1 megabyte to start using our application. Are microsoft planning to include DLR in SL 3 Core?<BR/><BR/>2. There is no integration in Visual Studio. Project IronPython shell wasn't updated since IP first version. <BR/><BR/>Thanks,<BR/>Alexey Zakharov.
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://www.blogger.com/profile/05370777584064015818">
  <div class="css-comment-name js-comment-name">
    Jimmy Schementi
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-25T18:46:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    @stimpy77 The XAP file is basically a filesystem to a SL app, since it doesn't have access to the local filesystem, just like JavaScript in the browser.<BR/><BR/>The latest release of AgDLR actually includes a auto-xapper for IIS/Cassini, so you can just put your files on the webserver and it will be served as a XAP whenever the directory containing those files is requested ... makes it that much easier.
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://www.blogger.com/profile/05370777584064015818">
  <div class="css-comment-name js-comment-name">
    Jimmy Schementi
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-25T18:57:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    @Alexey Zakharov To address your concerns:<BR/><BR/>&gt;&gt;&gt; DLR assemblies are not included to Silverlight Core<BR/><BR/>True. In SL4 part of the DLR will be in Silverlight, but the languages will never be, since their open-source projects and release 2-3 times faster than Silverlight.<BR/><BR/>To help with this, you can serve any DLL from outside the XAP (see chiron.exe.config for documentation), which are only downloaded once into the user&#39;s browser cache. SL3 improves upon this by packaging up DLLs in SLVX files for networks which forbid the transmission of DLLs.<BR/><BR/>A lot of the limitations we have for Dynamic Languages is explained here:<BR/><BR/>http://blog.jimmy.schementi.com/2008/05/story-of-ruby-and-python-in-silverlight.html<BR/><BR/>&gt;&gt;&gt; There is no integration in Visual Studio. Project IronPython shell wasn&#39;t updated since IP first version. <BR/><BR/>You can download addons to VS for Python/Ruby colorization, and SL apps for Ruby/Python can just be VS Website projects (see http://blogs.msdn.com/webnext/archive/2008/03/30/silverlight-dynamic-languages-in-visual-studio.aspx), so working in VS is definitely possible. You&#39;ll be missing intellisence, but having a REPL in your application (http://www.flickr.com/photos/24458122@N00/3039815620/) can make that a ton easier. <BR/><BR/>What else is stopping you from using VS?
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://www.blogger.com/profile/06759379443629667029">
  <div class="css-comment-name js-comment-name">
    Miguel Madero
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-28T13:06:00.000Z
  </div>
  </div>
  <div class="css-comment-title js-comment-title">
    Jimmy, <br><br>You mentioned Silverline, but I wan...
  </div>
  <div class="css-comment-content js-comment-content">
    Jimmy, <BR/><BR/>You mentioned Silverline, but I wanted to know wif this project has been updated or is still alive. I've not seen any updates since October 2008 and was wondering what was the state of the project. <BR/><BR/>It seems like a great idea.
  </div>
  <br/>
</div>
<div class="css-full-comment js-full-comment">
  <div class="css-comment-user-link js-comment-user-link">
  <a href="http://www.blogger.com/profile/05370777584064015818">
  <div class="css-comment-name js-comment-name">
    Jimmy Schementi
  </div>
  </a>
  <div class="css-comment-date js-comment-date">
    2009-03-31T02:33:00.000Z
  </div>
  </div>
  <div class="css-comment-content js-comment-content">
    I haven't had time to work on it in a while, but I'm planning to put some time into it for RailsConf this year, so expect a major update in May. It is a really fun project, so I can't wait to update it.
  </div>
  <br/>
</div>
</div>