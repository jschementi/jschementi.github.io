---
title: "IronRuby 0.9 Released!"
layout: "post"
permalink: "/2009/08/ironruby-09-released.html"
uuid: "8365420027701416090"
guid: "tag:blogger.com,1999:blog-5419182.post-8365420027701416090"
date: "2009-08-02 00:54:00"
updated: "2009-08-03 20:53:45"
description: 
blogger:
    siteid: "5419182"
    postid: "8365420027701416090"
    comments: "14"
categories: [OSCON, IronRuby, Release]
author: 
    name: "Jimmy Schementi"
    url: "https://plus.google.com/116380716127564408544?rel=author"
    image: "//lh6.googleusercontent.com/-Fl3zUgl9dMw/AAAAAAAAAAI/AAAAAAAABYQ/CvQezyGiMP4/s512-c/photo.jpg"
---

<div class="post-content">
<p align="center"><a href="http://lh5.ggpht.com/_OqCZhp9yI0Q/SnTjqaLzSeI/AAAAAAAAALw/bHORChmv7yk/s1600-h/ir-logo-white%5B4%5D.jpg"><img style="display: inline" title="ir-logo-white" alt="ir-logo-white" src="http://lh5.ggpht.com/_OqCZhp9yI0Q/SnTjqyQdzqI/AAAAAAAAAL0/CbgKyPqQXao/ir-logo-white_thumb%5B2%5D.jpg?imgmax=800" width="400" height="115" /></a> </p>  <p align="center">I'm pleased to announce a new release of IronRuby: 0.9!</p>  <p align="center"><font size="5"><strong><a href="http://ironruby.net/Download" target="_blank">Download IronRuby 0.9</a></strong></font></p>  <p align="center"><a href="http://github.com/ironruby/ironruby/zipball/v0.9.0" target="_blank">You can also get the source code for this release</a></p>  <p>It’s been a long ride since <a href="http://ironruby.net">IronRuby</a> was announced at <a href="http://videos.visitmix.com/MIX07/DEV02">MIX ‘07</a>, but now all eyes are focused on getting it to 1.0. The <a href="http://blog.jimmy.schementi.com/2009/03/ironruby-03-released.html" target="_blank">past</a> <a href="http://blog.jimmy.schementi.com/2009/05/ironruby-05-released.html" target="_blank">couple</a> of versions <a href="http://blog.jimmy.schementi.com/2009/07/ironruby-06-released.html" target="_blank">have made vast compatibility and performance improvements</a>, and 0.9 marks the last set of <strong>major</strong> features that will be added to IronRuby. From now on, all IronRuby languages will be primarily focused on bug fixing <strong>and</strong> anything else the community deems necessary to call IronRuby a 1.0 release. These improvements be delivered as point-point releases (0.9.1, 0.9.2, etc) until <strong>you </strong>decide it is ready to call 1.0.</p>  <p>Though IronRuby is breaking away from it’s conference-driven development schedule, this release comes only a week after <a href="http://en.oreilly.com/oscon2009" target="_blank">OSCON 2009</a> where I talked about using <a href="http://blog.jimmy.schementi.com/2009/07/ironruby-at-oscon-2009-mono-moonlight.html" target="_blank">IronRuby with Mono and Moonlight, and scripting open source apps</a>.</p>  <h4><font color="#ff8000" size="4">What's in the Release?</font></h4>  <p>Library performance was a big focus for this release; basically going though the <a href="http://github.com/acangiano/ruby-benchmark-suite" target="_blank">Ruby Benchmark suite</a> and making sure any obvious slowness was fixed. As I said in <a href="http://blog.jimmy.schementi.com/2009/07/ironruby-at-oscon-2009-mono-moonlight.html" target="_blank">my previous post about OSCON</a>, IronRuby is approximately 2x faster than MRI when running the benchmark suite, but in the near future a complete evaluation of IronRuby’s performance will be done and published on the <a href="http://ironruby.info" target="_blank">website</a>.</p>  <p><em><a href="http://antoniocangiano.com/" target="_blank">Antonio Cangiano</a> has already published <a href="http://antoniocangiano.com/2009/08/03/performance-of-ironruby-ruby-on-windows/" target="_blank">benchmark results between IronRuby 0.9 and Ruby 1.8.6, and things look really good for IronRuby</a>.</em></p>  <p>On the compatibility front, the <a href="http://ruby-doc.org/stdlib/libdoc/win32ole/rdoc/classes/WIN32OLE.html" target="_blank">Win32OLE Ruby library</a> is now <a href="http://github.com/ironruby/ironruby/blob/v0.9.0/Merlin/Main/Languages/Ruby/Libs/win32ole.rb" target="_blank">available in IronRuby</a>. This builds on top of IronRuby’s existing COM interop from version 0.5, letting you script any Windows component/application that exposes a <a href="http://msdn.microsoft.com/en-us/library/ms877981.aspx" target="_blank">COM</a> interface. Though it hasn’t been fully tested yet, this will make things like <a href="http://wtr.rubyforge.org/" target="_blank">Watir</a> work on IronRuby.</p>  <p>Lastly, there have been interop improvements with .NET, most notably making Generic types more friendly to all the crazy things Ruby can do to them, and also with other DLR languages, making it really easy to call IronPython from IronRuby.</p>  <p>For more detailed information, please see the <a href="http://rubyforge.org/frs/shownotes.php?release_id=37484" target="_blank">CHANGELOG</a> (which includes all commit messages for the release ... not just &quot;syncing to head of tfs&quot;)</p>  <p><strong><font color="#ff8000">Want to find out more about the release? Read on:</font></strong></p>  <ul>   <li><a href="#pytorb">Calling Python code from Ruby</a> </li>    <li><a href="#win32ole">Win32OLE support</a> </li>    <li><a href="#generics">Rubyizing Generics</a> </li>    <li><a href="#notable-changes">Some more notable changes</a> </li>    <li><a href="#bugs09">Bugs closed</a> </li> </ul>  <h5><a name="pytorb"></a><font color="#ff8000" size="3">Calling Python code from Ruby</font></h5>  <p>In an effort to allow Ruby to call Python code easily, IronRuby provides a way to importing files of other DLR languages, giving you access to the DLR scope. Here's a basic usage:</p> <script src="http://gist.github.com/159528.js"></script>  <p><code>IronRuby#require(path), load(path)</code> allow you to include script files, just like <code>Kernel#require, #load</code> except that they execute the given script against a <b>new</b> <code>Scope</code> and return it, instead of just returning true/false/nil. If the target is an assembly they return the loaded assembly. Keep in mind you can still use <code>Kernel#require, #load</code> to use other language's script files, but if the language requires you obtain an object representing that file (in Python it's called a <code>module</code>) you'll have to get it elsewhere (see below).</p>  <p>There are other methods to help you use other languages from Ruby:</p>  <ul>   <li><code>IronRuby#loaded_scripts</code> has also been added to returns a dictionary that holds on loaded scripts and their Scopes, in-case you used <code>Kernel#require</code> to load a script, and need its Scope at a later time. </li>    <li><code>IronRuby#loaded_assemblies</code> returns an array of assemblies already loaded in the current runtime; though this isn’t needed for DLR language interop it makes sense to include along with <code>IronRuby#loaded_scripts</code>. </li>    <li><code>IronRuby#globals</code> returns the current <code>ScriptRuntime.Globals</code> scope; this allows you to easily use Python files and work with the modules they define. </li> </ul>  <p>Keep in mind these concepts don’t only apply to Python; they can be used with any language that uses first-class scopes.</p>  <h5><a name="win32ole"></a><font color="#ff8000" size="3">Win32OLE support</font></h5>  <p>Since IronRuby 0.1 was released we’ve said <a href="http://ruby-doc.org/stdlib/libdoc/win32ole/rdoc/classes/WIN32OLE.html" target="_blank">Win32OLE</a> was not going to be supported, due to the lack of general COM support in the <a href="http://dlr.codeplex.com" target="_blank">DLR</a>. However, when the DLR implemented a COM binder for the new <a href="http://msdn.microsoft.com/en-us/library/dd264736(VS.100).aspx" target="_blank">dynamic feature in C# 4.0</a>, this allowed IronRuby and IronPython to easily implement COM support. IronRuby 0.5 had this support, but in this release we provided win32ole.rb to implement Ruby’s Win32OLE API. Here’s a simple automation example which opens Excel, adds some data, generates a chart, and rotates the chart. taken from the <a href="http://whytheluckystiff.net/ruby/pickaxe/html/win32.html" target="_blank">Ruby Pragmatic Programmer’s Guide (aka. the pickaxe book)</a>, which now works in IronRuby:</p> <script src="http://gist.github.com/159829.js"></script>  <h5><a name="generics"></a><font color="#ff8000" size="3">Rubyizing Generics</font></h5>  <p><em>Note: this feature didn’t make it into 0.9, but it is in the <a href="http://github.com/ironruby/ironruby" target="_blank">sources</a> and will be part of 0.9.1</em></p>  <p>IronRuby has great .NET framework integration, so code written with a CLI-based language (C#, VB, F#) can be called from IronRuby, without it feeling like interop. As we work towards a stable 1.0 release and this integration continues to be polished; in this release we most notably made working with generics a bit friendlier to Ruby.</p>  <p>The first improvement has to do with re-opening a generic class. In the past you couldn’t just re-open a generic class and assume anything you added to it would be found on other versions of that generic class (eg. adding methods to <code>List[]</code> wouldn’t have them show up on <code>List[String]</code> and <code>List[Fixnum]</code>). Now the Ruby class corresponding to the CLR generic type definition is a super-class of all instantiations of that type, making this possible:</p> <script src="http://gist.github.com/159861.js"></script>  <p>There's a much more usability improvements to generics and .NET interop in general in this release, so either take a look at the <a href="http://rubyforge.org/frs/shownotes.php?release_id=37484" target="_blank">CHANGELOG</a> or keep an eye on the <a href="http://ironruby.net/Documentation/.NET" target="_blank">.NET documentation</a>.</p>  <h5><a name="notable-changes"></a><font color="#ff8000" size="3">Some more notable changes:</font></h5>  <ul>   <li>Fix to Module#autoload so it doesn’t squash an existing constant </li>    <li>Fix parsing of YAML time strings </li>    <li>Replace DLR closures by a Ruby-specific implementation for performance </li>    <li>Implement StringIO#ungetc – used in ActiveSuppor </li>    <li>Re-implements “tr”, “tr!”, “tr_s”, “tr_s!”. The new implementation is almost 12x faster. </li>    <li>Reimplements “join” to achieve better perf. </li>    <li>Change ComBinder class to internal. </li>    <li>Improves the ExpressionVisitor API </li>    <li>Improves implementation of RubyArray. A loop doing Array#shift is not shifting the entire array content left every iteration. </li>    <li>Add hosting of IronPython to hosting tutorial </li>    <li>Implements interpretation of coalescing expression </li>    <li>Implements Kernel#rand, Kernel#srand. </li>    <li>Improves scope allocation perf. </li>    <li>ironruby tutorial in Silverlight </li>    <li>More fixes to win32ole to get the ADO DBI driver working </li>    <li>String, Array, and Bignum fixes (thanks Daniele Allessandri!) </li>    <li>Explicit x64 support with ir64.exe, and force ir.exe to run in a 32bit process on a 64bit OS. </li>    <li>Implements basic debug views for classes that implement IRubyObject </li> </ul>  <p>For more details, see the <a href="http://rubyforge.org/frs/shownotes.php?release_id=37484" target="_blank">CHANGELOG</a>.</p>  <h5><a name="bugs09"></a><font color="#ff8000" size="3">Bugs closed</font></h5>  <p>Here are all 26 bugs closed since the last release (2009-07-02). <a href="http://ironruby.codeplex.com/WorkItem/List.aspx" target="_blank">You can see more information about each one on CodePlex</a>.</p>  <pre style="overflow: scroll">1841 	Rubygems Test Failures in 'hash'
1506 	-X:PrivateBinding does not enable referring to classes that have internal visibility
1533 	Unverifiable code generated by mspec :lang
1678 	ArgumentError when calling System.String..ctor(Char[], int, int)
1211 	Adding a random object to Time which responds to to_f
910 	YAML does not properly deserialize Time values.
1626 	Rubygems failures
964 	overriding unsafe methods
1537 	rand doesn't work collectly
468 	Better error message for running ir.exe on pre-.Net 2.0 SP1
1787 	All-caps .NET method names are mangled strangely
1521 	Access is allowed to internal fields
1502 	alias_method fails for :do
821 	File.expand_path does not support a line number after filename
1509 	Proc.to_s should include line number where the block was declared
1501 	WinForms broken
1400 	$? is not always Process::Status
1345 	load_assembly(<partial_name>) should work
1344 	System.Action.new does not work
1306 	Cannot call CLR constructor of builtin type
1184 	public(:foo) does not work correctly for mixed-in methods
1060 	visibility of send :define_method
917 	Passing a Ruby array to a .NET method that expects an IEnumerable derivative fails with GetEnumerator call
783 	Assert in SetMethodBasesNoLock when calling #== on Ruby class inheriting from CLR class which overrides Equals
761 	Wrong behavior when calling redefined methods on object instances
1470 	Can't call the BigIntegerOverload of a method with a DefaultProtocol Attribute on the BigInteger attribute</pre>

<h5><font color="#ff8000" size="3">Enjoy!</font></h5>

<p>Please test out IronRuby 0.9 and let us know if you have any issues. We hope you enjoy this release! Please <a href="http://ironruby.codeplex.com/WorkItem/Create.aspx" target="_blank">submit issues to CodePlex</a> and help prioritize features for 1.0.</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:22650565-0430-4c01-bc82-33d6fda8be12" class="wlWriterEditableSmartContent">Technorati Tags: <a href="http://technorati.com/tags/IronRuby" rel="tag">IronRuby</a>,<a href="http://technorati.com/tags/Release" rel="tag">Release</a>,<a href="http://technorati.com/tags/OSCON" rel="tag">OSCON</a></div>  
</div>