---
title: "\"console=true\": REPLs in Silverlight"
layout: "post"
permalink: "/2008/11/repls-in-silverlight.html"
uuid: "9134717009753070621"
guid: "tag:blogger.com,1999:blog-5419182.post-9134717009753070621"
date: "2008-11-18 01:23:00"
updated: "2008-11-18 01:38:14"
description: 
blogger:
    siteid: "5419182"
    postid: "9134717009753070621"
    comments: "0"
categories: [ruby, talks, Silverlight]
author: 
    name: "Jimmy Schementi"
    url: "https://plus.google.com/116380716127564408544?rel=author"
    image: "//lh6.googleusercontent.com/-Fl3zUgl9dMw/AAAAAAAAAAI/AAAAAAAABYQ/CvQezyGiMP4/s512-c/photo.jpg"
---

<div class="post-content">
<p>At <a href="https://seattle.codecamp.us/">Seattle CodeCamp v4.0</a> today, I talked a lot about <a href="http://en.wikipedia.org/wiki/REPL">REPLs, or &quot;Read, Evaluate, Print Loops&quot;</a>. They are the true &quot;minimalist&quot; view of programming; type a line, run a line. Most of them are no frills, only a terminal window and a blinking cursor, though they themselves could be really rich development environments. Also, REPLs are a vital tool for runtime-compilation languages, since the methods/variables/classes/etc are only *really* known to exist at runtime. </p><p>I started my talk with a Ruby REPL showing off how you can use IronRuby to explore .NET.</p><p><a title="ruby-browser-repl" href="/images/flickr/3036629807_6f94543204_z.jpg"><img border="0" alt="ruby-browser-repl" src="/images/flickr/3036629807_6f94543204_z.jpg" width="400" height="400" /></a></p><p>Ah, the beauty of <a href="http://flickr.com/photos/jschementi/2898698253/">two worlds colliding</a>. You can use Ruby-idioms to explore the .NET types, starting with an A, B, or C, in the System namespace, just like they were Ruby classes to begin with. Call .NET methods, even with Ruby method naming conventions; IsInterface as is_interface. </p><p>The lurking awesomeness here is this REPL is running inside the browser! This is a <a href="http://msdn.microsoft.com/en-us/library/cc189089(VS.95).aspx">HTML-based Silverlight application</a>, which provides an IronRuby REPL. It accomplishes this by using the <a href="http://codeplex.com/dlr">Dynamic Language Runtime</a> (DLR) hosting APIs, but don't get hung up on the details of how that works, I'll explain later.</p><p><a title="Monkey patching" href="/images/flickr/3036887651_b7e2d60b42_w.jpg"><img border="0" alt="Monkey patching" src="/images/flickr/3036887651_b7e2d60b42_w.jpg" width="400" height="340" /></a></p><p>This is nothing *new* in my world. <a target="_blank" href="http://silverlight.net/samples/sl2/dlrconsole/index.html">DLRConsole</a> has been around for a while now, and lets you write code in the browser to manipulate a Silverlight canvas. Both REPLs are self-contained, as in they only work against code manually loaded into them, like the previous screenshot shows with loading in the clock.rb and drag.rb files. This is fine for trying small things out, but becomes very cumbersome when trying to interact with a live application.</p><p>To interact with a live application seamlessly, the bare minimum would be to have a REPL available directly in the application itself. <a href="http://github.com/jschementi/agdlr/commit/f7e4b6a22974209600b6b95a8126bf63db0cdcf6">And that's what I've done</a>:</p><p><a title="silverlight-repl" href="/images/flickr/3039815620_f085c6b6d7_z.jpg"><img border="0" alt="silverlight-repl" src="/images/flickr/3039815620_f085c6b6d7_z.jpg" width="400" height="305" /></a></p><p>If you build the <a href="http://github.com/jschementi/agdlr">latest bits</a>, you can add a new initParam option called &quot;console&quot; to enable a REPL in any application:</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:8761a212-ee2b-4c60-91a9-68decfaa5dbd" class="wlWriterSmartContent"><pre name="code" class="xml:nogutter:nocontrols">&lt;object ... &gt;
  ...
  &lt;param name="initParams" value="console=true" /&gt;
&lt;/object&gt;</pre></div><p>This will inject a HTML-based REPL into whatever web page your app is running on. The language of the REPL is set to whatever language your start script is. To make the console pretty, <a href="http://github.com/jschementi/agdlr/tree/master/samples/ruby/photoviewer/stylesheets/console.css?raw=true">add this stylesheet to your page</a>. Eventually this stylesheet will be included in the templates script/sl produces. </p><p>In the screenshot above, I did not type/click anything on the UI; the code I typed into the REPL set the search term and &quot;clicked&quot; the search button. This type of integration with your application could easily produce <a href="http://wtr.rubyforge.org/">Waitr</a>-like automation, for testing and whatnot. I'd really like to see Waitr ported to IronRuby. =</p><p>But there's plenty more to-do: this console is very simple.</p><ul><li>It only supports Ruby currently; though simple Python statements will work.</li>
<li>It supports single and multi-line statements, but since the text input is implemented on top of a &lt;input&gt; tag, browser history gets in the way =P </li>
<li>History works, but never resets itself. </li>
<li>If you make a typo, and it's not clear that you've intended for the statement to be completed (like typing &quot;class &lt;enter&gt;&quot;), you'll have to force the console to run the command with &lt;ctrl&gt;+&lt;enter&gt; </li>
</ul><p>Please, play around with this new &quot;usefulness&quot; and let me know what you think. I'd prefer you to leave comments on github, so everyone can participate in the discussion. The code for the REPL lives in <a href="http://github.com/jschementi/agdlr/tree/master/src/Microsoft.Scripting.Silverlight/Console.cs">Console.cs</a>, so if you want to fix something on the list above, or see something else broken, fix it! If you find more bugs, please post them to <a href="http://www.codeplex.com/sdlsdk/WorkItem/List.aspx">Codeplex</a> under the 0.x.0 release.</p><p>Hope this little feature makes your live a bit easier!</p>
</div>
