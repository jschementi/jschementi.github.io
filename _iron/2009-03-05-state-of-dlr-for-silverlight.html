---
title: "State of the DLR for Silverlight"
layout: "post"
permalink: "/2009/03/state-of-dlr-for-silverlight.html"
uuid: "4554019320262620641"
guid: "tag:blogger.com,1999:blog-5419182.post-4554019320262620641"
date: "2009-03-05 19:34:00"
updated: "2009-03-05 19:48:20"
description: 
blogger:
    siteid: "5419182"
    postid: "4554019320262620641"
    comments: "9"
categories: [ruby, Dynamic Languages, IronRuby, Silverlight, IronPython, DLR, Python]
author: 
    name: "Jimmy Schementi"
    url: "https://plus.google.com/116380716127564408544?rel=author"
    image: "//lh6.googleusercontent.com/-Fl3zUgl9dMw/AAAAAAAAAAI/AAAAAAAABYQ/CvQezyGiMP4/s512-c/photo.jpg"
---

<div class="post-content">
<p>If you’re a frequent reader of this blog, you definitely know what’s going on with the <a href="http://dlr.codeplex.com/" target="_blank">DLR</a> in <a href="http://silverlight.net" target="_blank">Silverlight</a>. For those who are new, or just don’t know, hopefully this post will clarify some things.</p>  <p>First off: my previous entries about Silverlight since <a href="http://sdlsdk.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=17839" target="_blank">sdlsdk-0.4.0</a> dropped:</p>  <ul>   <li><a href="http://blog.jimmy.schementi.com/2008/11/repls-in-silverlight.html" target="_blank">“console=true”: REPLs in Silverlight</a> </li>    <li><a href="http://blog.jimmy.schementi.com/2008/11/adding-scripting-to-c-silverlight-app.html" target="_blank">Adding scripting to a C# Silverlight app</a> </li>    <li><a href="http://blog.jimmy.schementi.com/2008/12/jimmy-hacking-at-microsoft.html" target="_blank">jimmy hacking (at) Microsoft</a> / Silverlight stuff near bottom </li>    <li><a href="http://blog.jimmy.schementi.com/2009/01/dynamic-language-testing-in-silverlight.html" target="_blank">Dynamic Language Testing in Silverlight</a> </li> </ul>  <p>It would seem the next release will be focused around REPLs, testing, scripting support, and maybe some server-side integration pieces. And you’d be right. Proof is in the <a href="http://github.com/jschementi/agdlr" target="_blank">project’s public source code repository</a>. </p>  <p><strong><font color="#ff8000">But what about the dynamic language runtime and the languages themselves?</font></strong></p>  <p>There has not been a new release of <a href="http://sdlsdk.codeplex.com/" target="_blank">sdlsdk</a> for many months, and that’s simply because the above features are not finished, NOT because the DLR and languages have not releases anything for Silverlight since then! The DLR released <a href="http://dlr.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=20378" target="_blank">dlr-0.9</a> and IronPython released <a href="http://ironpython.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=12481" target="_blank">ironpython-2.0.1</a>, both including Silverlight binaries. Also, <a href="http://www.devhawk.net/" target="_blank">Harry Pierson</a> put together a <a href="http://nightlybuilds.cloudapp.net/Project.aspx?project=dlr" target="_blank">nightly build site</a> for the DLR, which includes <a href="http://ironruby.net" target="_blank">IronRuby</a> and <a href="http://ironpython.codeplex.com" target="_blank">IronPython</a>, and had Silverlight-specific builds.</p>  <p><font color="#ff8000"><strong>Then why the sdlsdk project?</strong></font></p>  <p>sdlsdk is the main project and release vehicle for Chiron and Microsoft.Scripting.Silverlight, which makes writing applications in DLR-languages possible. It’s also the place for collaborating and experimenting with crazy usages of Silverlight+DLR. The DLR and languages are parts of other projects, so I can not justify bumping the version number of sdlsdk simply because a new version of IronRuby, IronPython, and the DLR are in there. The easiest way to update sdlsdk’s DLR+languages is to grab a daily build of the DLR and drop the binaries into sdlsdk’s /bin folder. The next sdlsdk release might include a script to automate that, as long as new builds don’t break it. =)</p>  <p>This is possible because the DLR, IronRuby, and IronPython teams use a shared continuous-integration server that runs test suites in Silverlight on each checkin, ensuring that they all continue to work really well.</p>  <h4><font color="#ff8000">Common misconceptions</font></h4>  <p>During development the state of these projects could be completely different within a few weeks, so misconceptions form very fast. Here are ones which beg for correction …</p>  <p><font color="#ff8000"><strong>Chiron, a special HTTP server, performs language compilation on the server and generates a .xap file.</strong></font></p>  <p><strong><font color="#ff8000">FALSE. </font></strong>While <a href="http://sdlsdk.codeplex.com/Wiki/View.aspx?title=Chiron&amp;referringTitle=Getting%20Started" target="_blank">Chiron</a> is a special HTTP server, which generates a XAP file for any given directory, <strong><font color="#ff8000">it does not perform language compilation on the server</font></strong>! Chiron is a development-time tool which only sticks the script files in the XAP, and they are run in the browser. When putting your app into production, you tell Chiron to write the XAP file to disk, and then you can put your app on any web-server you want. </p>  <p>Chiron’s existence shows the limitation Silverlight imposes by <em>requiring</em> a XAP file. DLLs can be downloaded by the AppManifest.xaml outside the XAP, so the XAP just serves as a AppManifest.xaml container. I’m hoping to get this fixed by Silverlight <strong><u>4</u></strong>. =\ It also shows a limitation in not supporting continuations, which would let the user script pause while asynchronously downloading a script file, and then resume the initial script. I’ve been prototyping ways to get around this, but nothing working yet. </p>  <p>Also, if you’re using another web-server in your app (like you have a ASP.NET app with a Silverlight control), you can just set up a file-system-watcher and tell Chiron to regenerate the XAP to disk everytime you edit a file, but it will be served with the other webserver. This is used by <a href="http://www.schementi.com/silverline/" target="_blank">silverline</a>, a Rails plugin I wrote to integration Silverlight and IronRuby.</p>  <p>This is why you can’t include JavaScript files from inside other JavaScript files, and all your dependencies need to be pre-defined in the HTML file, because JavaScript can’t download the script files while the JavaScript engine is running.</p>  <p><strong><font color="#ff8000">Common interface implementations were inconsistent between languages, so I can’t create a solution where advanced users can pick and choose a language.</font></strong></p>  <p><strong><font color="#ff8000">FALSE, in theory. </font></strong><a href="http://dlr.codeplex.com/Project/Download/FileDownload.aspx?DownloadId=59294" target="_blank">The DLR hosting API (contained in Microsoft.Scripting.dll)</a> provides a single set of APIs that can be used to host many languages. For example, <a href="http://github.com/jschementi/agdlr/blob/master/src/Microsoft.Scripting.Silverlight/DynamicApplication.cs" target="_blank">Microsoft.Scripting.Silverlight</a> uses the DLR hosting APIs to run any DLR language in Silverlight, based on what extension the entry-point script has (.py, .rb, etc ...). <a href="http://github.com/jschementi/orphanage/tree/master/hosting" target="_blank">There are simple hosting examples here.</a></p>  <p>It is the language’s responsibility to implement certain interfaces so they are host-able by the DLR. IronRuby and IronPython are existing examples of that, and there is documentation in the hosting spec on how this all works, so new languages can follow suit.</p>  <p>However, there are always going to be language-specific scenarios which have different ways of using the hosting API, or the hosting API doesn’t support the feature and you have to use the language’s hosting API. In those cases, it’s best to re-think your scripting design and make the hosting code as simple as possible.</p>  <p>Also, a couple months ago, IronRuby’s hosting support was no where near where it is today. Again, things change fast. If you have any feedback on DLR hosting, please ask around on the <a href="http://dlr.codeplex.com/Thread/List.aspx" target="_blank">DLR Discussions List</a>.</p>  <h4><font color="#ff8000">And the state is ...</font></h4>  <p>I hope that made some things clear; the DLR, IronRuby, and IronPython are committed to supporting Silverlight developers. Unfortunately, the reverse is less strong, so if this is important to you please talk about it on the <a href="http://silverlight.net/forums/17.aspx" target="_blank">silverlight.net forums</a>. Things might be a bit nicer when the inner ring of the DLR (Microsoft.Scripting.Core.dll) is part of the System.Core in Silverlight, but we’ll see.</p>  
</div>